# üö´ –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã Celery

–î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è —É—á–µ–±–Ω—ã—Ö –∏ –¥–∏–ø–ª–æ–º–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.  
–ï—Å–ª–∏ –∏–∑–±–µ–≥–∞—Ç—å —ç—Ç–∏—Ö –æ—à–∏–±–æ–∫ ‚Äî Celery –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.

---

## ‚ùå 1. –°–æ–∑–¥–∞–Ω–∏–µ Celery –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö

**–ü–ª–æ—Ö–æ**
```python
Celery(...)
```

**–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ**
- —Ä–∞–∑–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏
- –∑–∞–¥–∞—á–∏ –Ω–µ –≤–∏–¥–Ω—ã –≤–æ—Ä–∫–µ—Ä–∞–º

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
- –æ–¥–∏–Ω `Celery()` –≤ `core/celery_app.py`

---

## ‚ùå 2. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ Celery Beat

**–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ**
- Beat –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å
- –Ω–µ—Ç retry
- –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
- Beat —Ç–æ–ª—å–∫–æ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç
- Worker –≤—ã–ø–æ–ª–Ω—è–µ—Ç

---

## ‚ùå 3. –û–∂–∏–¥–∞–Ω–∏–µ ¬´—Ä–æ–≤–Ω–æ –æ–¥–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è¬ª

Celery —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **at-least-once**.

**–°–ª–µ–¥—Å—Ç–≤–∏–µ**
- –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

---

## ‚ùå 4. –í–Ω–µ—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã –±–µ–∑ retry

**–ü–ª–æ—Ö–æ**
```python
requests.post(...)
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
```python
@task(autoretry_for=(Exception,))
```

---

## ‚ùå 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ print –≤–º–µ—Å—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ**
- –Ω–µ—Ç —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–æ–≤
- —Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
```python
logging.getLogger(__name__)
```

---

## ‚ùå 6. async-–∫–ª–∏–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ Celery-–∑–∞–¥–∞—á

**–ó–∞–ø—Ä–µ—â–µ–Ω–æ**
- redis.asyncio
- async HTTP –∫–ª–∏–µ–Ω—Ç—ã

**–ü—Ä–∞–≤–∏–ª–æ**
- FastAPI ‚Üí async
- Celery ‚Üí sync

---

## ‚ùå 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤

**–ü–ª–æ—Ö–æ**
- –∑–∞–≤–∏—Å—à–∏–µ –≤–æ—Ä–∫–µ—Ä—ã
- —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
```python
soft_time_limit
time_limit
```

---

## ‚ùå 8. –ü–æ–¥–º–µ–Ω–∞ Celery BackgroundTasks

BackgroundTasks ‚â† Celery  
Celery ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –æ—á–µ—Ä–µ–¥—å.

---

## ‚ùå 9. –ù–µ—Å–∫–æ–ª—å–∫–æ Beat –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**
- –¥—É–±–ª–∏ –∑–∞–¥–∞—á
- –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

**–ü—Ä–∞–≤–∏–ª–æ**
- Beat –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω

---

## ‚ùå 10. –ù–∞–¥–µ–∂–¥–∞ –Ω–∞ autodiscover –±–µ–∑ –∏–º–ø–æ—Ä—Ç–æ–≤

**–§–∞–∫—Ç**
- –µ—Å–ª–∏ –º–æ–¥—É–ª—å –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω ‚Äî –∑–∞–¥–∞—á –Ω–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**
- `tasks/__init__.py` —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏

---

## ‚ùå 11. –í–æ–∑–≤—Ä–∞—Ç –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞–¥–∞—á

**–ü–ª–æ—Ö–æ**
```python
return huge_object
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ë–î
- –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å id

---

## ‚ùå 12. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Celery –∫–∞–∫ message bus

Celery ‚â† Kafka  
Celery ‚Äî –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –∞ –Ω–µ –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π.

---

## üß† –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞

1. –ó–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
2. Worker –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
3. Beat –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å
4. Redis –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–∏—â–µ–Ω
5. –ö–æ–¥ –¥–æ–ª–∂–µ–Ω —ç—Ç–æ –ø–µ—Ä–µ–∂–∏—Ç—å

---

## üéì –î–ª—è –¥–∏–ø–ª–æ–º–∞

> Celery ‚Äî at-least-once —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–¥–∞—á,  
> –ø–æ—ç—Ç–æ–º—É –≤—Å–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã,  
> —Å retry –∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º ACK.

---
